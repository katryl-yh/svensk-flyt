version: 2

models:
  - name: dim_airline
    description: Airline dimension table with unique airline identifiers
    columns:
      - name: airline_key
        description: Surrogate key for airline dimension
        tests:
          - unique
          - not_null
      - name: airline_iata
        description: IATA airline code
        tests:
          - unique
          - not_null
      - name: airline_name
        description: Airline operator name

  - name: fct_airline_performance
    description: >
      Airline performance fact table with punctuality and delay metrics.
      Supports KPIs: Punctuality, Airline performance
    columns:
      - name: airline_key
        description: Foreign key to dim_airline
        tests:
          - not_null
      - name: total_flights
        description: Total number of flights (including deleted/cancelled)
      - name: active_flights
        description: Non-deleted flights
      - name: completed_flights
        description: Flights with actual times (landed/departed)
      - name: on_time_flights
        description: Flights that were on-time (delay <= 15 minutes)
      - name: on_time_percentage
        description: Percentage of completed flights that were on-time
      - name: avg_delay_minutes
        description: Average delay in minutes
      - name: median_delay_minutes
        description: Median delay in minutes (more robust than average)
      - name: domestic_flights
        description: Count of domestic Swedish flights
      - name: international_flights
        description: Count of international flights
